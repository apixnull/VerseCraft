@model IEnumerable<VerseCraft.Models.Anthology>
@{
    ViewData["Title"] = "Anthology Management";
}
<link rel="stylesheet" href="~/css/displayAnthology.css" asp-append-version="true" />

<div class="container">
    <div class="header">
        <h2><i class='bx bx-book'></i> Anthology List</h2>
        <div class="header-actions">
            <input type="text" id="search" placeholder="Search..." onkeyup="searchTable()" class="search-input" />
            <a asp-area="admin" asp-controller="Anthology" asp-action="addAnthology" class="btn-add">
                <i class='bx bx-plus'></i> Add Anthology
            </a>
        </div>
    </div>

    <div class="table-wrapper">
        <table id="anthologyTable">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Title</th>
                    <th>Author</th>
                    <th style="text-align:center;">Actions</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model)
                {
                    <tr>
                        <td>@item.Id</td>
                        <td>@item.Title</td>
                        <td>@item.Author</td>
                        <td class="actions">
                            <a asp-area="admin" asp-controller="Anthology" asp-action="UpdateAnthology" asp-route-id="@item.Id" class="action-btn edit"> <i class='bx bx-edit'></i> </a>
                            <a href="#" class="action-btn delete" onclick="confirmDelete(@item.Id)"><i class='bx bx-trash'></i></a>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<form id="deleteForm" method="post" asp-area="admin" asp-controller="Anthology" asp-action="DeleteAnthology" style="display:none;">
    @Html.AntiForgeryToken()
    <input type="hidden" name="id" id="deleteId" />
</form>

<script>
    function searchTable() {
        let input = document.getElementById("search").value.toLowerCase();
        let rows = document.querySelectorAll("#anthologyTable tbody tr");
        rows.forEach(row => {
            let text = row.innerText.toLowerCase();
            row.style.display = text.includes(input) ? "" : "none";
        });
    }


    function confirmDelete(id) {
        Swal.fire({
            title: 'Delete this anthology?',
            text: "This action cannot be undone.",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#d33',
            cancelButtonColor: '#3085d6',
            confirmButtonText: 'Yes, delete it!',
            cancelButtonText: 'Cancel',
            reverseButtons: true
        }).then((result) => {
            if (result.isConfirmed) {
                document.getElementById("deleteId").value = id;
                document.getElementById("deleteForm").submit();
            }
        });
    }
</script>
